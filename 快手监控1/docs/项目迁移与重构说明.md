# 项目迁移与重构说明

## 概述
- 将 `electron-ks` 前端并入 `快手监控1` 渲染进程，形成一体化 Electron 应用。
- 用 IPC 替换 WebSocket，所有业务逻辑在主进程实现，无外部后端。

## 目录变更
- 渲染进程：合并 `src/components`、`src/views`、`src/stores`、`src/composables`、`src/utils`。
- 预加载：`src/preload/index.js` 暴露 `api` 方法与事件订阅。
- 主进程：新增 `src/main/ipc/routes.js` 与 `src/main/services/*`。

## 通信协议
- 请求：`get_all_kuaishou_data`、`get_all_roi_data`、`refresh_data`、`update_interval`、`update_roi`（通过 `ipcMain.handle`）。
- 推送：`users_data`、`kuaishou_data`、`roi_data`、`update_roi_result`、`error`、`connection_established`（`webContents.send`）。

## 持久化
- 用户库：打包携带 `Sqlite3.db`（`electron-builder.yml` 配置）。
- 概览历史：`userData/overview.json` 保存最近一帧用于消耗变化计算。

## 打包与运行
- 开发：`npm i` → `npm run dev`。
- 打包：`npm run build:win` / `npm run build:mac`。

## 验证清单
- 首次打开收到 `connection_established`，页面自动拉取快手与 ROI 数据。
- 刷新按钮与倒计时行为正常；修改 ROI 成功后立即刷新 ROI。
- 离线运行不依赖任何外部后端服务。

## 变更引用
- 预加载：`快手监控1/src/preload/index.js:1-20`。
- 主进程：`快手监控1/src/main/index.js:1-36`、`快手监控1/src/main/ipc/routes.js:1-120`。
- 渲染进程：`快手监控1/src/renderer/src/utils/socket.js:1-120`、`快手监控1/src/renderer/src/composables/useWebSocket.js:1-226`。
