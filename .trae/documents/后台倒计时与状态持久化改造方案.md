## 问题原因

* Portable 单文件 EXE会在临时目录解压并运行，`app.getPath('exe')` 返回的是临时运行路径，导致无法检测桌面上与 EXE 同目录的 `Sqlite3.db`。

* 最高压缩与单文件封装更易触发杀软的启发式规则。

## 改动方案

1. 数据库路径解析

* 使用 `process.env.PORTABLE_EXECUTABLE_DIR` 获取原始 EXE 所在目录（portable 模式下由 electron-builder 设置）。

* 生产环境统一以 `PORTABLE_EXECUTABLE_DIR` 作为同目录数据库路径；开发环境保持原有回退。

* 启动时检查缺失时在弹窗中显示实际检查的目录，便于用户定位。

1. 打包降敏

* 将 `electron-builder.yml` 的 `compression` 从 `maximum` 改为 `normal`，降低单文件启发式误报概率。

* 保持 `asar: true` 与 `portable` 目标不变。

## 具体修改

* `src/main/index.js`：

  * `exeDir = process.env.PORTABLE_EXECUTABLE_DIR || dirname(app.getPath('exe'))`

  * 弹窗文案包含 `exeDir`，并记录日志

* `src/main/services/userService.js`：

  * 生产环境 `resolveDbPath()` 返回 `join(PORTABLE_EXECUTABLE_DIR, 'Sqlite3.db')` 回退到 `dirname(app.getPath('exe'))`

* `electron-builder.yml`：

  * `compression: normal`

## 验证

* 将 `快手监控工具-*.exe` 与 `Sqlite3.db` 放在同一目录（如桌面或任意文件夹）运行：应能成功读取数据库。

* 如缺失：提示中显示具体检查目录；5 秒后退出。

* 杀软误报概率下降，如仍误报可在杀软中添加信任或考虑使用安装包目标（nsis）。

